<div class="flex flex-col flex-auto min-w-0">
    <fuse-alert *ngIf="(fuseAlert.alert$ | async) as alert"
        [type]="alert.type" [appearance]="'fill'" [dismissible]="true" (closed)="fuseAlert.clearAlert()" @shake
        class="mb-4">
        {{ alert.message }}
    </fuse-alert>

    <!-- Main -->
    <div class="flex-auto p-6 sm:p-10">
        <div class="h-400 min-h-400 max-h-400 rounded-2xl">
            <!-- Tablo Başlığı ve Filtreler aynı satırda -->
            <div class="flex flex-col sm:flex-row sm:items-center sm:gap-4 gap-2 mb-4">
                <h2 class="text-3xl font-bold text-gray-800 mb-0 whitespace-nowrap">{{ 'doctorSignatures.title' | transloco }}</h2>
                <button mat-flat-button [color]="'primary'" class="min-w-[140px] h-10 rounded-md"
                    (click)="onOpenCreateModal()">
                    <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                    <span class="ml-2">{{ 'doctorSignatures.addNewSignature' | transloco }}</span>
                </button>
                <mat-form-field appearance="fill" class="fuse-mat-dense w-full sm:w-64"
                    [subscriptSizing]="'dynamic'">
                    <mat-icon matPrefix [svgIcon]="'heroicons_outline:search'"></mat-icon>
                    <input matInput [(ngModel)]="search" (input)="onSearchChange()" type="search"
                        placeholder="{{ 'doctorSignatures.searchPlaceholder' | transloco }}" class="always-visible-placeholder">
                </mat-form-field>
            </div>

            <div class="overflow-x-auto rounded-2xl shadow-lg border border-gray-200 bg-white">
                <div class="min-w-[1200px]"> <!-- Minimum width to ensure proper table layout -->
                    <table class="w-full bg-white rounded-2xl overflow-hidden text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="text-center px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">#</th>
                                <th class="px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">{{ 'doctorSignatures.displayName' | transloco }}</th>
                                <th class="px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">{{ 'doctorSignatures.degree' | transloco }}</th>
                                <th class="px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">{{ 'doctorSignatures.degreeNo' | transloco }}</th>
                                <th class="px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">{{ 'doctorSignatures.diplomaNo' | transloco }}</th>
                                <th class="px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">{{ 'doctorSignatures.registerNo' | transloco }}</th>
                                <th class="text-center px-3 py-4 font-semibold text-gray-700 whitespace-nowrap">{{ 'doctorSignatures.actions' | transloco }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let signature of paginatedDoctorSignatures; let i = index"
                                class="border-b last:border-0 hover:bg-primary-50 transition min-h-[56px]">
                                <td class="text-center font-bold text-gray-600 px-3 py-3 align-middle">{{ (pageIndex * pageSize) + i + 1 }}</td>
                                <td class="px-3 py-3 text-gray-800 align-middle font-semibold">{{ signature.displayName }}</td>
                                <td class="px-3 py-3 text-gray-800 align-middle">{{ signature.degree }}</td>                                <td class="px-3 py-3 text-gray-800 align-middle font-mono text-xs">{{ signature.degreeNo }}</td>
                                <td class="px-3 py-3 text-gray-800 align-middle font-mono text-xs">{{ signature.diplomaNo }}</td>
                                <td class="px-3 py-3 text-gray-800 align-middle font-mono text-xs">{{ signature.registerNo }}</td>
                                <td class="text-center px-3 py-3 align-middle">
                                    <div class="flex justify-center items-center">
                                        <button mat-icon-button
                                            [matMenuTriggerFor]="actionMenu" [matMenuTriggerData]="{signature: signature}"
                                            class="h-8 w-8 hover:bg-gray-100 rounded-full transition-colors flex items-center justify-center"
                                            title="İşlemler" aria-label="İşlemler">
                                            <!-- 3 nokta ikonu -->
                                            <div class="flex flex-col items-center justify-center space-y-0.5">
                                                <div class="w-1 h-1 bg-gray-600 rounded-full"></div>
                                                <div class="w-1 h-1 bg-gray-600 rounded-full"></div>
                                                <div class="w-1 h-1 bg-gray-600 rounded-full"></div>
                                            </div>
                                        </button>
                                    </div>
                                </td>
                            </tr>                            <!-- Empty State Row -->
                            <tr *ngIf="paginatedDoctorSignatures.length === 0" class="border-b">
                                <td colspan="7" class="text-center py-12">
                                    <div class="flex flex-col items-center justify-center text-gray-500">
                                        <mat-icon [svgIcon]="'heroicons_outline:pencil'"
                                            class="icon-size-12 mb-4 text-gray-400"></mat-icon>
                                        <h3 class="text-lg font-medium text-gray-700 mb-2">
                                            {{ search && search.trim() !== '' ? ('doctorSignatures.noSearchResults' | transloco) : ('doctorSignatures.noSignatures' | transloco) }}
                                        </h3>
                                        <p class="text-sm text-gray-500 max-w-md">
                                            {{ search && search.trim() !== '' ?
                                            ('doctorSignatures.tryDifferentSearch' | transloco) :
                                            ('doctorSignatures.addNewSignatureHint' | transloco)
                                            }}
                                        </p>
                                        <button *ngIf="!search || search.trim() === ''" mat-flat-button
                                            [color]="'primary'" (click)="onOpenCreateModal()"
                                            class="mt-4 min-w-[300px] h-10 rounded-md">
                                            <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                                            <span class="ml-2">
                                                {{ translocoService.getActiveLang() === 'tr' ? 'İmza Ekle' : 'Add New Signature' }}
                                            </span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <mat-paginator *ngIf="filteredDoctorSignatures.length > 0" [length]="filteredDoctorSignatures.length"
                    [pageSize]="pageSize" [pageIndex]="pageIndex" [pageSizeOptions]="[5, 10, 20]"
                    (page)="onPageChange($event)" [showFirstLastButtons]="true">
                </mat-paginator>
            </div>
        </div>

        <!-- Doctor Signature Actions Menu -->
        <mat-menu #actionMenu="matMenu" class="doctor-signature-actions-menu">
            <ng-template matMenuContent let-signature="signature">
                <button mat-menu-item (click)="editDoctorSignature(signature)" class="flex items-center">
                    <mat-icon class="icon-size-4 mr-3 text-blue-600">edit</mat-icon>
n                    <span class="text-sm">
                        {{ (translocoService.getActiveLang() === 'tr') ? 'Güncelle' : 'Update' }}
                    </span>
                </button>
                <button mat-menu-item (click)="deleteById(signature)" class="flex items-center">
                    <mat-icon class="icon-size-4 mr-3 text-red-600">delete</mat-icon>
                    <span class="text-sm">
                        {{ (translocoService.getActiveLang() === 'tr') ? 'Sil' : 'Delete' }}
                    </span>
                </button>
            </ng-template>
        </mat-menu>

        <!-- Create Modal -->
        <div *ngIf="showCreateModal"
            class="fixed inset-0 z-[1000] flex items-center justify-center bg-black bg-opacity-50 p-4"
            style="z-index: 1000;">
            <div class="bg-white rounded-3xl shadow-2xl w-full max-w-4xl border border-gray-200 relative max-h-[90vh] overflow-hidden flex flex-col"
                style="z-index: 1001;">
                <!-- Modal Header -->
                <div
                    class="flex justify-between items-center border-b px-6 sm:px-8 py-6 sticky top-0 bg-white rounded-t-3xl z-10 flex-shrink-0">
                    <h1 class="text-2xl font-bold text-gray-800">Doktor İmzası Ekleme Formu</h1>
                    <button mat-icon-button (click)="closeModal()" class="ml-4" aria-label="Kapat">
                        <mat-icon [svgIcon]="'heroicons_outline:x'"></mat-icon>
                    </button>
                </div>

                <!-- Modal Body with Stepper -->
                <div class="flex-1 overflow-y-auto">
                    <mat-stepper #stepper orientation="horizontal" linear class="p-4 sm:p-6"
                        (selectionChange)="onStepChange($event)">
                        <!-- Step 1: Signature Information -->
                        <mat-step [stepControl]="signatureInfoForm" label="İmza Bilgileri">
                            <form [formGroup]="signatureInfoForm" class="space-y-4 py-4">
                                <div class="text-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-1">İmza Bilgileri</h3>
                                    <p class="text-sm text-gray-600">Doktor imza bilgilerini giriniz</p>
                                </div>

                                <!-- Display Name and Degree -->
                                <div class="name-fields-container">
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Görünen İsim</mat-label>
                                            <input matInput id="displayName" formControlName="displayName"
                                                placeholder="Doktor görünen ismi" maxlength="100" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('displayName')?.hasError('required')">
                                                Görünen isim zorunludur
                                            </mat-error>
                                            <mat-error *ngIf="signatureInfoForm.get('displayName')?.hasError('minlength')">
                                                En az 2 karakter olmalıdır
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Uzmanlık Alanı</mat-label>
                                            <input matInput formControlName="degree"
                                                placeholder="Uzmanlık alanı" maxlength="100" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('degree')?.hasError('required')">
                                                Uzmanlık alanı zorunludur
                                            </mat-error>
                                            <mat-error *ngIf="signatureInfoForm.get('degree')?.hasError('minlength')">
                                                En az 2 karakter olmalıdır
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <!-- Degree No and Diploma No -->
                                <div class="name-fields-container">
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Derece Numarası</mat-label>
                                            <input matInput formControlName="degreeNo"
                                                placeholder="Derece numarası" maxlength="50" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('degreeNo')?.hasError('required')">
                                                Derece numarası zorunludur
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Diploma Numarası</mat-label>
                                            <input matInput formControlName="diplomaNo"
                                                placeholder="Diploma numarası" maxlength="50" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('diplomaNo')?.hasError('required')">
                                                Diploma numarası zorunludur
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <!-- Register No -->
                                <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                    [subscriptSizing]="'dynamic'">
                                    <mat-label>Kayıt Numarası</mat-label>
                                    <input matInput formControlName="registerNo"
                                        placeholder="Kayıt numarası" maxlength="50" autocomplete="off"
                                        class="always-visible-placeholder">
                                    <mat-error *ngIf="signatureInfoForm.get('registerNo')?.hasError('required')">
                                        Kayıt numarası zorunludur
                                    </mat-error>
                                </mat-form-field>

                                <div class="flex justify-end pt-2">
                                    <button mat-flat-button matStepperNext [color]="'accent'"
                                        [disabled]="signatureInfoForm.invalid" class="min-w-[120px] h-10 rounded-md">
                                        İmza Çizimi
                                        <mat-icon class="ml-2">arrow_forward</mat-icon>
                                    </button>
                                </div>
                            </form>
                        </mat-step>

                        <!-- Step 2: Signature Canvas -->
                        <mat-step [stepControl]="signatureCanvasForm" label="İmza Çizimi">
                            <form [formGroup]="signatureCanvasForm" class="space-y-4 py-4">
                                <div class="text-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-1">İmza Çizimi</h3>
                                    <p class="text-sm text-gray-600">İmzanızı aşağıdaki alana çiziniz</p>
                                </div>

                                <!-- Signature Canvas -->
                                <div class="signature-container">
                                    <div class="flex justify-between items-center mb-4">
                                        <label class="text-sm font-medium text-gray-700">İmza Alanı</label>
                                        <button type="button" mat-stroked-button (click)="clearSignature()" 
                                                class="h-8 text-xs">
                                            <mat-icon class="icon-size-4 mr-1">clear</mat-icon>
                                            Temizle
                                        </button>
                                    </div>                                    <canvas #signatureCanvas class="signature-canvas w-full border border-dashed border-gray-300 rounded-lg cursor-crosshair bg-white" 
                                            width="400" height="200"
                                            style="max-width: 100%; height: 200px; touch-action: none;">
                                        Tarayıcınız canvas elementini desteklemiyor.
                                    </canvas>
                                    <p class="text-xs text-gray-500 mt-2">
                                        Mouse veya dokunmatik ekranla imzanızı çizin
                                    </p>                                    <mat-error *ngIf="signatureCanvasForm.get('signature')?.hasError('required') && signatureCanvasForm.get('signature')?.touched">
                                        İmza çizimi zorunludur
                                    </mat-error>
                                </div>

                                <div class="flex justify-between pt-2">
                                    <button mat-stroked-button matStepperPrevious class="min-w-[120px] h-10 rounded-md">
                                        <mat-icon class="mr-2">arrow_back</mat-icon>
                                        Geri
                                    </button>
                                </div>
                            </form>
                        </mat-step>
                    </mat-stepper>
                </div>

                <!-- Modal Footer -->
                <div class="border-t px-4 sm:px-6 py-3 bg-gray-50 rounded-b-3xl flex-shrink-0">
                    <!-- Alert Section -->
                    <div class="mb-3" *ngIf="showModalAlert">
                        <fuse-alert [appearance]="'outline'" [showIcon]="false" [type]="modalAlert?.type"
                            [@shake]="modalAlert?.type === 'error'" class="w-full">
                            {{modalAlert?.message}}
                        </fuse-alert>
                    </div>
                    <!-- Buttons Section -->
                    <div class="flex flex-col sm:flex-row justify-end items-center gap-3">
                        <button *ngIf="isLastStep" type="button" mat-flat-button [color]="'warn'" (click)="closeModal()"
                            [disabled]="loading"
                            class="w-full sm:w-auto min-w-[120px] h-10 rounded-md order-2 sm:order-1">
                            İptal
                        </button>
                        <button *ngIf="isLastStep" type="button" mat-flat-button [color]="'primary'" (click)="create()"
                            class="w-full sm:w-auto min-w-[120px] h-10 rounded-md order-1 sm:order-2"
                            [disabled]="loading || signatureInfoForm.invalid || signatureCanvasForm.invalid">
                            <span *ngIf="!loading">İmza Ekle</span>
                            <span *ngIf="loading" class="flex items-center gap-2">
                                <mat-progress-spinner [diameter]="16" [mode]="'indeterminate'"
                                    color="primary"></mat-progress-spinner>
                                Kaydediliyor...
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Update Modal -->
        <div *ngIf="showUpdateModal"
            class="fixed inset-0 z-[1000] flex items-center justify-center bg-black bg-opacity-50 p-4"
            style="z-index: 1000;">
            <div class="bg-white rounded-3xl shadow-2xl w-full max-w-4xl border border-gray-200 relative max-h-[90vh] overflow-hidden flex flex-col"
                style="z-index: 1001;">
                <!-- Modal Header -->
                <div
                    class="flex justify-between items-center border-b px-6 sm:px-8 py-6 sticky top-0 bg-white rounded-t-3xl z-10 flex-shrink-0">
                    <h1 class="text-2xl font-bold text-gray-800">Doktor İmzası Güncelleme Formu</h1>
                    <button mat-icon-button (click)="closeModal()" class="ml-4" aria-label="Kapat">
                        <mat-icon [svgIcon]="'heroicons_outline:x'"></mat-icon>
                    </button>
                </div>

                <!-- Modal Body with Stepper -->
                <div class="flex-1 overflow-y-auto">
                    <mat-stepper #updateStepper orientation="horizontal" linear class="p-4 sm:p-6"
                        (selectionChange)="onStepChange($event)">
                        <!-- Step 1: Signature Information -->
                        <mat-step [stepControl]="signatureInfoForm" label="İmza Bilgileri">
                            <form [formGroup]="signatureInfoForm" class="space-y-4 py-4">
                                <div class="text-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-1">İmza Bilgileri</h3>
                                    <p class="text-sm text-gray-600">Doktor imza bilgilerini güncelleyiniz</p>
                                </div>

                                <!-- Display Name and Degree -->
                                <div class="name-fields-container">
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Görünen İsim</mat-label>
                                            <input matInput id="updateDisplayName" formControlName="displayName"
                                                placeholder="Doktor görünen ismi" maxlength="100" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('displayName')?.hasError('required')">
                                                Görünen isim zorunludur
                                            </mat-error>
                                            <mat-error *ngIf="signatureInfoForm.get('displayName')?.hasError('minlength')">
                                                En az 2 karakter olmalıdır
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Uzmanlık Alanı</mat-label>
                                            <input matInput id="updateDegree" formControlName="degree"
                                                placeholder="Uzmanlık alanı" maxlength="100" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('degree')?.hasError('required')">
                                                Uzmanlık alanı zorunludur
                                            </mat-error>
                                            <mat-error *ngIf="signatureInfoForm.get('degree')?.hasError('minlength')">
                                                En az 2 karakter olmalıdır
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <!-- Degree No and Diploma No -->
                                <div class="name-fields-container">
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Derece Numarası</mat-label>
                                            <input matInput formControlName="degreeNo"
                                                placeholder="Derece numarası" maxlength="50" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('degreeNo')?.hasError('required')">
                                                Derece numarası zorunludur
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                    
                                    <div class="name-field-wrapper">
                                        <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                            [subscriptSizing]="'dynamic'">
                                            <mat-label>Diploma Numarası</mat-label>
                                            <input matInput formControlName="diplomaNo"
                                                placeholder="Diploma numarası" maxlength="50" autocomplete="off"
                                                class="always-visible-placeholder">
                                            <mat-error *ngIf="signatureInfoForm.get('diplomaNo')?.hasError('required')">
                                                Diploma numarası zorunludur
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>

                                <!-- Register No -->
                                <mat-form-field appearance="fill" class="fuse-mat-dense w-full"
                                    [subscriptSizing]="'dynamic'">
                                    <mat-label>Kayıt Numarası</mat-label>
                                    <input matInput formControlName="registerNo"
                                        placeholder="Kayıt numarası" maxlength="50" autocomplete="off"
                                        class="always-visible-placeholder">
                                    <mat-error *ngIf="signatureInfoForm.get('registerNo')?.hasError('required')">
                                        Kayıt numarası zorunludur
                                    </mat-error>
                                </mat-form-field>

                                <div class="flex justify-end pt-2">
                                    <button mat-flat-button matStepperNext [color]="'accent'"
                                        [disabled]="signatureInfoForm.invalid" class="min-w-[120px] h-10 rounded-md">
                                        İmza Çizimi
                                        <mat-icon class="ml-2">arrow_forward</mat-icon>
                                    </button>
                                </div>
                            </form>
                        </mat-step>

                        <!-- Step 2: Signature Canvas -->
                        <mat-step [stepControl]="signatureCanvasForm" label="İmza Çizimi">
                            <form [formGroup]="signatureCanvasForm" class="space-y-4 py-4">
                                <div class="text-center mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 mb-1">İmza Çizimi</h3>
                                    <p class="text-sm text-gray-600">İmzanızı güncelleyiniz</p>
                                </div>

                                <!-- Current Signature Preview -->
                                <div *ngIf="signatureDataUrl" class="mb-4">
                                    <label class="text-sm font-medium text-gray-700 block mb-2">Mevcut İmza</label>
                                    <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
                                        <img [src]="signatureDataUrl" alt="Mevcut İmza" 
                                             class="max-h-20 object-contain mx-auto">
                                    </div>
                                </div>

                                <!-- Signature Canvas -->
                                <div class="signature-container">
                                    <div class="flex justify-between items-center mb-4">
                                        <label class="text-sm font-medium text-gray-700">Yeni İmza Alanı</label>
                                        <button type="button" mat-stroked-button (click)="clearSignature()" 
                                                class="h-8 text-xs">
                                            <mat-icon class="icon-size-4 mr-1">clear</mat-icon>
                                            Temizle
                                        </button>
                                    </div>                                    <canvas #updateSignatureCanvas class="signature-canvas w-full border border-dashed border-gray-300 rounded-lg cursor-crosshair bg-white" 
                                            width="400" height="200"
                                            style="max-width: 100%; height: 200px; touch-action: none;">
                                        Tarayıcınız canvas elementini desteklemiyor.
                                    </canvas>
                                    <p class="text-xs text-gray-500 mt-2">
                                        Yeni imza çizmek için yukarıdaki alana çizin (İsteğe bağlı)                                    </p>
                                </div>

                                <div class="flex justify-between pt-2">
                                    <button mat-stroked-button matStepperPrevious class="min-w-[120px] h-10 rounded-md">
                                        <mat-icon class="mr-2">arrow_back</mat-icon>
                                        Geri
                                    </button>
                                </div>
                            </form>
                        </mat-step>
                    </mat-stepper>
                </div>

                <!-- Modal Footer -->
                <div class="border-t px-4 sm:px-6 py-3 bg-gray-50 rounded-b-3xl flex-shrink-0">
                    <!-- Alert Section -->
                    <div class="mb-3" *ngIf="showModalAlert">
                        <fuse-alert [appearance]="'outline'" [showIcon]="false" [type]="modalAlert?.type"
                            [@shake]="modalAlert?.type === 'error'" class="w-full">
                            {{modalAlert?.message}}
                        </fuse-alert>
                    </div>
                    <!-- Buttons Section -->
                    <div class="flex flex-col sm:flex-row justify-end items-center gap-3">
                        <button *ngIf="isLastStep" type="button" mat-flat-button [color]="'warn'" (click)="closeModal()"
                            [disabled]="loading"
                            class="w-full sm:w-auto min-w-[120px] h-10 rounded-md order-2 sm:order-1">
                            İptal
                        </button>
                        <button *ngIf="isLastStep" type="button" mat-flat-button [color]="'primary'" (click)="update()"
                            class="w-full sm:w-auto min-w-[120px] h-10 rounded-md order-1 sm:order-2"
                            [disabled]="loading || signatureInfoForm.invalid">
                            <span *ngIf="!loading">İmzayı Güncelle</span>
                            <span *ngIf="loading" class="flex items-center gap-2">
                                <mat-progress-spinner [diameter]="16" [mode]="'indeterminate'"
                                    color="primary"></mat-progress-spinner>
                                Güncelleniyor...
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
